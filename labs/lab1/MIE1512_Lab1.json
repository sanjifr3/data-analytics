{"paragraphs":[{"text":"/*\nLab 01\n\nFor this lab, you will be introduced to Data Scientist Workbench and Zeppelin Notebooks. You will be using SQL Spark and the Scala programming language to import, review, and manipulate two CSV files about Github's Python repositories and contributions. This is a partial dataset for this class. The full dataset can be explored later.\n\nScala is an object oriented functional programming language. Scala source code is intended to be compiled to Java bytecode, so that the resulting executable code runs on a Java virtual machine. For this reason you will see many Java libraries used within Scala code.\n*/","dateUpdated":"2017-01-24T04:15:37+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485192016718_-1354883452","id":"20170123-013554_144088649","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"2017-01-23T05:20:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:69","dateFinished":"2017-01-24T04:15:37+0000","dateStarted":"2017-01-24T04:15:37+0000","focus":true},{"text":"// import required libraries\nimport java.sql.Timestamp\nimport org.apache.commons.io.IOUtils\nimport java.net.URL","dateUpdated":"2017-01-24T03:41:39+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485192016718_-1354883452","id":"20170123-013613_1350744463","dateCreated":"2017-01-23T05:20:16+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:70","dateFinished":"2017-01-24T03:41:40+0000","dateStarted":"2017-01-24T03:41:39+0000","focus":true},{"text":"/*\nPart 1 - loading Github's Python repositories CSV\n*/","dateUpdated":"2017-01-23T05:21:53+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485192110199_216167256","id":"20170123-172150_1933986803","dateCreated":"2017-01-23T05:21:50+0000","dateStarted":"2017-01-23T05:21:53+0000","dateFinished":"2017-01-23T05:21:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:71","errorMessage":""},{"text":"// URL of CSV file\nval pythonRepositoriesPath = \"https://drive.google.com/uc?export=download&id=0B4-QnHc0OvzxOERPbkdaWnpYY00\"\n\n// load Github's python repositories csv\nval reposCSV = sc.parallelize(IOUtils.toString(new URL(pythonRepositoriesPath)).split(\"\\n\"))\n\n// convert text file into an Resilient Distributed Dataset (RDD)\nval reposRDD = reposCSV.map(line => line.split(\",\").map(elem => elem.trim))","dateUpdated":"2017-01-24T03:43:18+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485192016718_-1354883452","id":"20170123-013856_1904822427","dateCreated":"2017-01-23T05:20:16+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:72","dateFinished":"2017-01-24T03:41:46+0000","dateStarted":"2017-01-24T03:41:43+0000","focus":true},{"text":"/*\nLet's get familiarized with the data.\n\nTake a look at the first record.\n*/\n\nval look = reposRDD.take(1)","dateUpdated":"2017-01-24T03:41:50+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485192016718_-1354883452","id":"20170123-013905_1042105349","dateCreated":"2017-01-23T05:20:16+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:73","dateFinished":"2017-01-24T03:41:54+0000","dateStarted":"2017-01-24T03:41:50+0000","focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485229276992_5336002","id":"20170124-034116_1451980880","dateCreated":"2017-01-24T03:41:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:955","text":"/*\nCSV Fields:\n    1. Repository name\n    2. Repository owner\n    3. Date of creation\n    4. Date of last update\n    5. Number of stargazers (people who \"stared\" this repository)\n    6. Number of forks (people who \"forked\" this repository, meaning created a copy of this repository in their account to work on it)\n*/","dateUpdated":"2017-01-24T04:02:45+0000","dateFinished":"2017-01-24T04:02:45+0000","dateStarted":"2017-01-24T04:02:45+0000","errorMessage":""},{"text":"/*\nStep 1.3\n\nLet's load the Github data into a Spark SQL instance\n\nWe first need a Contribution class. By passing a class, Spark gives us SQL Schema information for free.\n\nThe Contribution class below already has the correct data type assigned to each column in the CSV row.\n\nThis information will be used to generate the SQL schema for this file.\n*/","dateUpdated":"2017-01-24T03:45:47+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485192016718_-1354883452","id":"20170123-013912_1407180193","dateCreated":"2017-01-23T05:20:16+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:74","dateFinished":"2017-01-24T03:45:47+0000","dateStarted":"2017-01-24T03:45:47+0000","focus":true},{"text":"case class Repository(\n    repositoryName: String,\n    ownerLogin: String,\n    createdAt: java.sql.Timestamp,\n    updatedAt: java.sql.Timestamp,\n    stargazersCount: Int,\n    forksCount: Int\n    )","dateUpdated":"2017-01-24T03:48:18+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485192016718_-1354883452","id":"20170123-014616_1343835587","dateCreated":"2017-01-23T05:20:16+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:75","dateFinished":"2017-01-24T03:48:19+0000","dateStarted":"2017-01-24T03:48:19+0000","focus":true},{"text":"/*\nLet's clean up the data before instantiating an instance of Station.\n\nWe create a function called getRepository() that receives an array representing one row of the CSV, formats the row elements, and returns an instantiated Station object.\n*/","dateUpdated":"2017-01-24T03:48:07+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485192016718_-1354883452","id":"20170123-014741_1432758642","dateCreated":"2017-01-23T05:20:16+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:76"},{"text":"// clean up Station fields, choose the ones we want, and convert them to proper formats\ndef getRepository(row:Array[String]):Repository = {\n    return Repository(\n        row(0),\n        row(1),\n        Timestamp.valueOf(row(2).replace(\"T\", \" \").replace(\"Z\", \"\")), // Timestamp.valueOf expects dates in the format \"yyyy-mm-dd hh:mm\"\n        Timestamp.valueOf(row(3).replace(\"T\", \" \").replace(\"Z\", \"\")),\n        row(4).toInt,\n        row(5).toInt\n    )\n}","dateUpdated":"2017-01-24T03:48:21+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485192016718_-1354883452","id":"20170123-014927_630549074","dateCreated":"2017-01-23T05:20:16+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77","dateFinished":"2017-01-24T03:48:21+0000","dateStarted":"2017-01-24T03:48:21+0000","focus":true},{"text":"/*\nStep 1.4\n\nLoad the github data into SQL Spark\n*/","dateUpdated":"2017-01-23T05:20:16+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485192016718_-1354883452","id":"20170123-015339_940994500","dateCreated":"2017-01-23T05:20:16+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:78"},{"text":"// load the data into a DataFrame used for SparkSQL\nval reposDF = reposRDD.map(row => getRepository(row)).toDF()\n\n// register this data as an SQL table\nreposDF.registerTempTable(\"repositories\")\n\n// Let's take a look at the schema and data\nreposDF.printSchema","dateUpdated":"2017-01-24T03:48:25+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485192016718_-1354883452","id":"20170123-015735_1681573974","dateCreated":"2017-01-23T05:20:16+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:79","dateFinished":"2017-01-24T03:48:34+0000","dateStarted":"2017-01-24T03:48:25+0000","focus":true},{"text":"/*\n.count return the numebr of records\nNotice how long it takes to run this command\n*/\nreposDF.count","dateUpdated":"2017-01-24T03:49:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485192016719_-1355268201","id":"20170123-020313_553405745","dateCreated":"2017-01-23T05:20:16+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:80","focus":true,"dateFinished":"2017-01-24T03:49:07+0000","dateStarted":"2017-01-24T03:49:06+0000"},{"text":"// Lets take a look at the data\nreposDF.show()","dateUpdated":"2017-01-24T03:49:53+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485192016719_-1355268201","id":"20170123-020009_1603307978","dateCreated":"2017-01-23T05:20:16+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:81","dateFinished":"2017-01-24T03:49:54+0000","dateStarted":"2017-01-24T03:49:53+0000","focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485229750339_-955659481","id":"20170124-034910_771944313","dateCreated":"2017-01-24T03:49:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1216","text":"/*\nWe run count again. Notice how long it takes this time.\n*/\nreposDF.count","dateUpdated":"2017-01-24T03:50:00+0000","dateFinished":"2017-01-24T03:49:30+0000","dateStarted":"2017-01-24T03:49:30+0000","errorMessage":""},{"text":"// DataFrame provides a describe() function that gives you essential statistics about particular columns.\nreposDF.describe().show()","dateUpdated":"2017-01-24T03:49:58+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485192016719_-1355268201","id":"20170123-020609_562574510","dateCreated":"2017-01-23T05:20:16+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:82","dateFinished":"2017-01-24T03:49:59+0000","dateStarted":"2017-01-24T03:49:58+0000","focus":true},{"text":"/*\nSQL Queries:\n    1. List 10 newest repositories\n    2. List all unique logins\n    3. List all the users with more than 1 repository\n    4. List the number of repositories created per year\n*/","dateUpdated":"2017-01-24T04:02:15+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485192016719_-1355268201","id":"20170123-022323_350966322","dateCreated":"2017-01-23T05:20:16+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:83","dateFinished":"2017-01-24T04:02:16+0000","dateStarted":"2017-01-24T04:02:16+0000","focus":true},{"text":"%sql\nSELECT * FROM repositories order by createdAt DESC LIMIT 10","dateUpdated":"2017-01-23T05:20:16+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"repositoryName","index":0,"aggr":"sum"}],"values":[{"name":"ownerLogin","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"repositoryName","index":0,"aggr":"sum"},"yAxis":{"name":"ownerLogin","index":1,"aggr":"sum"}}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485192016719_-1355268201","id":"20170123-020339_762367812","dateCreated":"2017-01-23T05:20:16+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:84"},{"text":"%sql\nSELECT DISTINCT ownerLogin from repositories","dateUpdated":"2017-01-23T05:20:16+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485192016719_-1355268201","id":"20170123-020438_779451208","dateCreated":"2017-01-23T05:20:16+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:85"},{"text":"%sql\nSELECT ownerLogin, COUNT(repositoryName) as repositoriesCount\nFROM repositories \nGROUP BY ownerLogin \nHAVING repositoriesCount > 1 \nORDER BY repositoriesCount DESC","dateUpdated":"2017-01-23T05:20:16+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485192016721_-1345264729","id":"20170123-022546_1681269933","dateCreated":"2017-01-23T05:20:16+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:86"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":true,"keys":[{"name":"createdYear","index":0,"aggr":"sum"}],"values":[{"name":"repositoriesCount","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"createdYear","index":0,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485229817547_-1911132206","id":"20170124-035017_2140512026","dateCreated":"2017-01-24T03:50:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1348","text":"%sql\nSELECT YEAR(CreatedAt) createdYear, COUNT(repositoryName) repositoriesCount\nFROM repositories\nGROUP BY YEAR(CreatedAt)\nORDER BY createdYear ASC","dateUpdated":"2017-01-24T04:01:51+0000","dateFinished":"2017-01-24T04:01:42+0000","dateStarted":"2017-01-24T04:01:41+0000","errorMessage":""},{"text":"/*\nPart 2 - Github Contributions\n*/","dateUpdated":"2017-01-23T05:20:16+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485192016721_-1345264729","id":"20170123-021651_1464310145","dateCreated":"2017-01-23T05:20:16+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:87"},{"text":"//URL of contributions CSV file\nval pythonContributionsPath = \"https://drive.google.com/uc?export=download&id=0B4-QnHc0OvzxTnJjcktIbktZOTg\"\n\n// load Github's python repositories csv\nval contrCSV = sc.parallelize(IOUtils.toString(new URL(pythonContributionsPath)).split(\"\\n\"))\n\n// convert text file into an Resilient Distributed Dataset (RDD)\nval contrRDD = contrCSV.map(line => line.split(\",\").map(elem => elem.trim))","dateUpdated":"2017-01-24T04:02:31+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485192016721_-1345264729","id":"20170123-023547_1294595798","dateCreated":"2017-01-23T05:20:16+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:88","dateFinished":"2017-01-24T04:02:34+0000","dateStarted":"2017-01-24T04:02:32+0000","focus":true},{"text":"contrRDD.take(1)","dateUpdated":"2017-01-24T04:02:35+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485192016721_-1345264729","id":"20170123-023719_654008351","dateCreated":"2017-01-23T05:20:16+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:89","dateFinished":"2017-01-24T04:02:35+0000","dateStarted":"2017-01-24T04:02:35+0000","focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485230590808_-1240408725","id":"20170124-040310_1928427020","dateCreated":"2017-01-24T04:03:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2195","text":"/*\nCSV Fields:\n    1. Repository name\n    2. Contributor login\n    3. Number of code contributions made by the contributor (field 2) to the repository (field 1)\n*/","dateUpdated":"2017-01-24T04:04:07+0000","dateFinished":"2017-01-24T04:04:07+0000","dateStarted":"2017-01-24T04:04:07+0000","errorMessage":""},{"text":"// Defining a class for contribution\ncase class Contribution(\n    repository: String,\n    login: String,\n    contributions: Int\n    )","dateUpdated":"2017-01-24T04:04:15+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485192016721_-1345264729","id":"20170123-023734_1735703592","dateCreated":"2017-01-23T05:20:16+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:90","dateFinished":"2017-01-24T04:04:16+0000","dateStarted":"2017-01-24T04:04:15+0000","focus":true},{"text":"// patching the String class with new functions that have a defualt value if conversion to another type fails.\n// it will help us to clean datasets easier\n\nimplicit class StringConversion(val s: String) {\ndef toTypeOrElse[T](convert: String=>T, defaultVal: T) = try {\n    convert(s)\n  } catch {\n    case _: NumberFormatException => defaultVal\n  }\n  \n  def toIntOrElse(defaultVal: Int = 0) = toTypeOrElse[Int](_.toInt, defaultVal)\n  def toDoubleOrElse(defaultVal: Double = 0D) = toTypeOrElse[Double](_.toDouble, defaultVal)\n}","dateUpdated":"2017-01-24T04:04:18+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485192016721_-1345264729","id":"20170123-023847_1876003829","dateCreated":"2017-01-23T05:20:16+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:91","dateFinished":"2017-01-24T04:04:19+0000","dateStarted":"2017-01-24T04:04:18+0000","focus":true},{"text":"def getContribution(row:Array[String]):Contribution = {\n  return Contribution(\n    row(0),\n    row(1),\n    row(2).toIntOrElse()\n  )\n}","dateUpdated":"2017-01-24T04:04:21+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485192016721_-1345264729","id":"20170123-024725_164446980","dateCreated":"2017-01-23T05:20:16+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:92","dateFinished":"2017-01-24T04:04:21+0000","dateStarted":"2017-01-24T04:04:21+0000","focus":true},{"text":"// load the data into a DataFrame used for SparkSQL\nval contrDF = contrRDD.map(row => getContribution(row)).toDF()\n\n// register this data as an SQL table\ncontrDF.registerTempTable(\"contributions\")\n\n// Let's take a look at the schema and data\ncontrDF.printSchema","dateUpdated":"2017-01-24T04:04:24+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485192016721_-1345264729","id":"20170123-025018_608468762","dateCreated":"2017-01-23T05:20:16+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:93","dateFinished":"2017-01-24T04:04:25+0000","dateStarted":"2017-01-24T04:04:24+0000","focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485231280239_-1061687666","id":"20170124-041440_336594989","dateCreated":"2017-01-24T04:14:40+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3245","text":"/*\n\nWrite the 3 following queries. Make sure you present the results in a meaningful order.\n\n*/","dateUpdated":"2017-01-24T04:15:20+0000"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485231285593_-1770764564","id":"20170124-041445_446190074","dateCreated":"2017-01-24T04:14:45+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3315","text":"// Query 1. List all unique logins in reverse alphabetic order (starting from z)","dateUpdated":"2017-01-24T04:15:20+0000"},{"text":"%sql\nSELECT ","dateUpdated":"2017-01-24T04:15:36+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"login","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"login","index":0,"aggr":"sum"}}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485192016722_-1344110483","id":"20170123-025609_1938557646","dateCreated":"2017-01-23T05:20:16+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:95"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485231293296_-1549317764","id":"20170124-041453_1175825076","dateCreated":"2017-01-24T04:14:53+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3389","text":"// Query 2. List contributors that contributed to more than 20 repositories","dateUpdated":"2017-01-24T04:15:20+0000"},{"text":"%sql\nSELECT ","dateUpdated":"2017-01-24T04:15:36+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"login","index":0,"aggr":"sum"}],"values":[],"groups":[],"scatter":{"xAxis":{"name":"login","index":0,"aggr":"sum"}}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485192016723_-1344495232","id":"20170123-025621_1746913559","dateCreated":"2017-01-23T05:20:16+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:96"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485231306629_853839190","id":"20170124-041506_1551649082","dateCreated":"2017-01-24T04:15:06+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3465","text":"// Query 3. Calculate for every repository the number of contributing users, and the average number of contributions to user","dateUpdated":"2017-01-24T04:15:20+0000"},{"text":"%sql\nSELECT ","dateUpdated":"2017-01-24T04:15:37+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"repository","index":0,"aggr":"sum"}],"values":[{"name":"count(login)","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"repository","index":0,"aggr":"sum"},"yAxis":{"name":"count(login)","index":1,"aggr":"sum"}}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485192016723_-1344495232","id":"20170123-025643_1228457383","dateCreated":"2017-01-23T05:20:16+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:97"},{"text":"/*\nPart 3 - Combining the two datasets\n\nExample query: All the repositories that have more stargazers than total number of contributions\n*/","dateUpdated":"2017-01-24T04:07:28+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485192016727_-1346034227","id":"20170123-025728_1377153603","dateCreated":"2017-01-23T05:20:16+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:98","dateFinished":"2017-01-24T04:07:28+0000","dateStarted":"2017-01-24T04:07:28+0000","focus":true},{"text":"%sql\nSELECT r.repositoryName, r.stargazersCount, SUM(c.contributions) as numContributions\nFROM repositories r JOIN contributions c ON r.repositoryName = c.repository\nGROUP BY r.repositoryName, r.stargazersCount\nHAVING r.stargazersCount > numContributions\norder by (r.stargazersCount - numContributions) DESC","dateUpdated":"2017-01-24T04:05:31+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"repositoryName","index":0,"aggr":"sum"}],"values":[{"name":"stargazersCount","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"repositoryName","index":0,"aggr":"sum"},"yAxis":{"name":"stargazersCount","index":1,"aggr":"sum"}}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485192016728_-1347957972","id":"20170123-170151_1745968659","dateCreated":"2017-01-23T05:20:16+0000","dateStarted":"2017-01-24T04:05:31+0000","dateFinished":"2017-01-24T04:05:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2472","errorMessage":""},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485230852020_-139659091","id":"20170124-040732_1515764152","dateCreated":"2017-01-24T04:07:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2565","text":"/*\n\nWrite the 4 following queries. Make sure you present the results in a meaningful order.\n\n*/","dateUpdated":"2017-01-24T04:08:06+0000","dateFinished":"2017-01-24T04:08:06+0000","dateStarted":"2017-01-24T04:08:06+0000","errorMessage":""},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485230797847_-1242977730","id":"20170124-040637_736034806","dateCreated":"2017-01-24T04:06:37+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2399","text":"// Query 1. All the repositories that have more forks than total number of contributions","dateUpdated":"2017-01-24T04:07:00+0000","errorMessage":""},{"text":"%sql\nSELECT","dateUpdated":"2017-01-24T04:14:26+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"repositoryName","index":0,"aggr":"sum"}],"values":[{"name":"forksCount","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"repositoryName","index":0,"aggr":"sum"},"yAxis":{"name":"forksCount","index":1,"aggr":"sum"}}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485192016731_-1347573223","id":"20170123-170553_627824739","dateCreated":"2017-01-23T05:20:16+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:100"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485230872877_747587197","id":"20170124-040752_332450713","dateCreated":"2017-01-24T04:07:52+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2635","text":"// Query 2. All the users that the sum of the stars for the repositories they contributed to is larger than 50,000 ","dateUpdated":"2017-01-24T04:08:34+0000","errorMessage":""},{"text":"%sql\nSELECT ","dateUpdated":"2017-01-24T04:14:26+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"login","index":0,"aggr":"sum"}],"values":[{"name":"sumStargazers","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"login","index":0,"aggr":"sum"},"yAxis":{"name":"sumStargazers","index":1,"aggr":"sum"}}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485192016732_-1349496967","id":"20170123-164358_826409131","dateCreated":"2017-01-23T05:20:16+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485230890848_-1871767991","id":"20170124-040810_1576183001","dateCreated":"2017-01-24T04:08:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2711","text":"// Query 3. All repositories with their number of contributors, forks count, and stargazers count","dateUpdated":"2017-01-24T04:08:18+0000","dateFinished":"2017-01-24T04:08:18+0000","dateStarted":"2017-01-24T04:08:18+0000","errorMessage":""},{"text":"%sql\nSELECT ","dateUpdated":"2017-01-24T04:14:26+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485192016732_-1349496967","id":"20170123-163204_1250393035","dateCreated":"2017-01-23T05:20:16+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:102"},{"text":"// Query 4. For every year, sum the contributions made to repositories created in this year","dateUpdated":"2017-01-24T04:10:51+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485192016737_-1363732677","id":"20170123-165627_334689152","dateCreated":"2017-01-23T05:20:16+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:103"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"year(CAST(createdAt AS DATE))","index":0,"aggr":"sum"}],"values":[{"name":"sum(contributions)","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"year(CAST(createdAt AS DATE))","index":0,"aggr":"sum"},"yAxis":{"name":"sum(contributions)","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485230944002_-813030963","id":"20170124-040904_72402451","dateCreated":"2017-01-24T04:09:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2787","text":"%sql\nSELECT ","dateUpdated":"2017-01-24T04:13:57+0000","dateFinished":"2017-01-24T04:10:43+0000","dateStarted":"2017-01-24T04:10:41+0000","errorMessage":""},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1485231040944_-1566983920","id":"20170124-041040_618649539","dateCreated":"2017-01-24T04:10:40+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2877","dateUpdated":"2017-01-24T04:10:51+0000","errorMessage":"","text":""}],"name":"Lab1","id":"2C9YFGDG7","angularObjects":{"2C1FSWPV5:shared_process":[],"2C2ANMC3H:shared_process":[],"2C27C2CAW:shared_process":[],"2C1EQ4DYT:shared_process":[],"2C2D85D6Q:shared_process":[],"2BYMYHYE7:shared_process":[],"2BZJ3HWCJ:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}